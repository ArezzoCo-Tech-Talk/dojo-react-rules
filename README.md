# Regras n√£o escritas do React

## Estado

O que voc√™ precisa saber sobre os estados do React:

- ele ditar√° quando deve mudar a renderiza√ß√£o;
- n√£o tem a necessidade de ser duplicado, pois pode ser enviado a outros componentes por props.

### üö´ Estado com valor redundante

Muito importante lembrar, o estado dita a renderiza√ß√£o, ent√£o n√£o √© preciso criar um estado baseado no valor de outro, pois quando aquele mudar, vai passar renderizando tudo abaixo

**errado**
```js
function Somadora() {
  const [n√∫mero1, setN√∫mero] = React.useState(0);
  const [n√∫mero2, setN√∫mero2] = React.useState(0);
  const [soma, setSoma] = React.useState(0);

  function handleClick() {
    setN√∫mero(numero1 + 1);
  }

  function handleClick() {
    setN√∫mero2(numero + 1);
  }

  React.useState(() => {
    setSoma(n√∫mero1 + n√∫mero2);
  }, [n√∫mero]);

  return (
    <div>
      <button onClick={handleClick}>acrescentar n√∫mero 1</button>
      <button onClick={handleClick2}>acrescentar n√∫mero 2</button>
      {soma}
    </div>
  );
}
```

**certo**
```js
function Somadora() {
  const [n√∫mero1, setN√∫mero] = React.useState(0);
  const [n√∫mero2, setN√∫mero2] = React.useState(0);
  const soma = n√∫mero1 + n√∫mero2;

  function handleClick() {
    setN√∫mero(numero1 + 1);
  }

  function handleClick() {
    setN√∫mero2(numero + 1);
  }

  return (
    <div>
      <button onClick={handleClick}>acrescentar n√∫mero 1</button>
      <button onClick={handleClick2}>acrescentar n√∫mero 2</button>
      {soma}
    </div>
  );
}
```

**Estado = DOM**, quando o estado muda a renderiza√ß√£o muda, logo, a tela s√≥ se atualiza com `setState`. Talvez isso j√° esteja claro, mas achei bom refor√ßar.

No caso de aplica√ß√µes que n√£o usam um m√°quina de estados como redux, para diminuir o fluxo de props por componentes o estado deve ficar no n√≠vel mais baixo poss√≠vel.

![image](https://user-images.githubusercontent.com/27368585/81748437-3ee2d800-9480-11ea-8eab-ef8d8f62dd55.png)

Na imagem o valor do frete s√≥ √© necess√°rio para renderizar ali onde aquele componente cuida. Agora digamos que precisamos desse valor no irm√£o dele, o componente de valor total.

![image](https://user-images.githubusercontent.com/27368585/81748696-a8fb7d00-9480-11ea-880f-bf57ab4ab08a.png)

Agora subimos o estado para todos naquele n√≠vel ou abaixo poderem usar.

### Sinais de que isso est√° sendo feito errado

Quando mais do que um n√≠vel tem o mesmo estado.

```js
function CalculaFrete(props) {
  const [valor, setValor] = React.useState(0);

  function handleValor(novoValor) {
    setValor(novoValor);
    props.setValorFrete(novoValor);
  }

  // ...
}
```

## Cuidado com loops

Cada vez que setamos um estado o React chama nosso componente de novo e se passar por aquele "setador" de estado ele vai setar e reiniciar o componente sem parar. Algumas coisas que podem ser feitas para isso n√£o acontecer.

### seEffect

Nunca setar estado automaticamente fora do `useEffect`.

Quando o estado √© um objeto ou array prefira um `setState` s√≠ncrono: `setState(prevValue => ...)`

`Component.propTypes` vem acompanhado do `Component.defaultProps` e ambos devem ser usados.

L√≥gica no meio do c√≥digo fica feio.

## Props

As Props tem padr√µes de nomes e formas de trabalhar com elas.

### Envie o resto das props para o elemento

O intuito √© que tudo que est√° no par√¢metro `...props` v√° para o primeiro elemento, repare que peguei o id abaixo, mas n√£o tirei ele do props.

Nesse exemplo estou fazendo um controle encadeado de id.

```js
function StepCard({
  label,
  children,
  disabled,
  ...props
}) {
  const { id } = props;

  return (
    <div className="card" {...props}>
      <Accordion
        id={`${id}-accordion`}
        label={label}
      >
        <div className="card__body">
          {children}
        </div>
      </Accordion>
    </div>
  )
}
```

### Props com nomes nativos

Cuidar para n√£o dar um nome que n√£o seja o nativo quando for mandar um prop para um elemento.

**errado**
```js
function CustomForm() {
  return (
    <CustomInput customClass="input-custom" />
  );
}
```

**errado**
```js
function CustomForm() {
  return (
    <CustomInput className="input-custom" />
  );
}
```

### Nomenclatura de props de eventos

Para o elemento mandamos com o prefixo `on`, dentro do componente manipulamos com o prefixo `handle`.

```js
function CustomButton({ onClick, children, ...props }) {
  handleClick(event) {
    onClick(event);
  }
  
  return <button onClick={handleClick} {...props}>{button}</button>;
}
```

### ClassName & Classes

O classes √© uma regra n√£o escrita onde enviamos um objeto com as classes de um componente complexo.

**exemplo do Material UI**
```js
<Button
  classes={{
    root: classes.root, // class name, e.g. `classes-nesting-root-x`
    label: classes.label, // class name, e.g. `classes-nesting-label-x`
  }}
>
  classes nesting
</Button>
```
